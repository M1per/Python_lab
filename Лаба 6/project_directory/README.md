# Лабораторная работа №6


# Задание 1
*Условие задания:* 

По своему варианту задания создайте пакет, содержащий 3 модуля, и подключите его к основной программе.
Основная программа должна предоставлять:
графический пользовательский интерфейс с возможностями ввода требуемых параметров и отображения результатов расчёта,
возможность сохранить результаты в отчёт формата .doc или .xls (например, пакеты python-docx и openpyxl)

Мой вариант 6, поэтому мое задание:

Элементарные частицы

Электрон
Нейтрон
Протон
Расчёт удельного заряда, комптоновской длины волны.


Из GUI фреймворков я выбрал для себя, что буду работать на PySimpleGUI, так как это улучшенная версия Tkinter и для моих задач отлично подходит.




*Ход решения:* 


1. Перед началом разработки я установил необходимые библиотеки PySimpleGUI. Проверил правильность установки с помощью простого скрипта.


2. Создал структуру проекта


3. Далее начал разработку модулей.


       3.1 Модуль __init__.py


Этот файл делает директорию particle_calculator пакетом Python. Он может быть пустым, но его наличие обязательно для того, чтобы Python распознал директорию как пакет.


       3.2 Модуль calculations.py


Этот модуль содержит функции для выполнения расчетов: удельного заряда и комптоновской длины волны:


calculate_specific_charge(mass, charge) — функция для расчета удельного заряда, который равен заряду частицы, деленному на её массу.


calculate_compton_wavelength(mass) — функция для расчета комптоновской длины волны, используя формулу λ= mc/h, где h — постоянная Планка, m — масса частицы, c — скорость света.


      3.3 Модуль file_operations.py


Этот модуль содержит функции для сохранения результатов расчетов в файлы форматов .docx и .xlsx:


save_to_docx(filename, data) — функция для сохранения данных в документ Word. Она создает новый документ, добавляет в него параграфы с данными и сохраняет файл.


save_to_xlsx(filename, data) — функция для сохранения данных в файл Excel. Она создает новую рабочую книгу, добавляет данные в активный лист и сохраняет файл.



     3.4 Модуль gui.py


Этот модуль содержит функцию для создания и управления графическим интерфейсом с использованием библиотеки PySimpleGUI:


   a) Импорт библиотек:


PySimpleGUI as sg — импорт библиотеки для создания графического интерфейса.


from .calculations import ... — импорт функций для расчетов из модуля calculations.


from .file_operations import ... — импорт функций для сохранения данных из модуля file_operations



   б) Определение макета интерфейса:


sg.Text("Выберите частицу") — текстовый элемент с подсказкой.


sg.Combo(...) — выпадающий список для выбора частицы.


sg.Button(...) — кнопки для выполнения действий.


sg.Text("", size=(20, 1), key='-SPECIFIC_CHARGE-') — текстовые элементы для отображения результатов расчетов


   в) Создание окна:


   Создание окна с заголовком "Калькулятор частиц" и заданным макетом командой: window = sg.Window("Калькулятор частиц", layout)


   г) Цикл обработки событий:

Цикл while True продолжается до тех пор, пока пользователь не закроет окно.


event, values = window.read() — чтение события и значений из интерфейса.


if event == sg.WIN_CLOSED: — закрытие окна при нажатии на кнопку закрытия.


elif event == "Рассчитать": — обработка события нажатия кнопки "Рассчитать".


Получение выбранной частицы из выпадающего списка.


Установка соответствующих значений массы и заряда для выбранной частицы.


Вызов функций calculate_specific_charge и calculate_compton_wavelength для выполнения расчетов.


Обновление текстовых элементов интерфейса для отображения результатов.


Сохранение результатов в словарь data для дальнейшего использования.


   д) Обработка сохранения данных:


   elif event == "Сохранить как DOCX" - обработк события нажатия кнопки "Сохранить как DOCX" (открытие диалогового окна дляф выбора имени файла и вызов функции save_to_dock для сохранения данных в файл ворд)


Тоже самое и для XLSX


       3.5 Модуль main.py

if __name__ == "__main__" - это условие, гарантирующее, что функция  create_gui будет запущена только тогда, когда файл main.py выполняется на прямую, а не импортируется как модуль.



Результат работы кода:

![image](https://github.com/user-attachments/assets/a07e7620-93b9-4b3c-b25a-82361f749873)



​
 






# Список источников:

1.  [Сделай то, сделай это, сделай сам PySimpleGUI](https://habr.com/ru/articles/662986/)
2.  [Создаём графический интерфейс на Python за 10 минут](https://thecode.media/py-gui/)
3.  [Питон и графический интерфейс ](https://otus.ru/journal/piton-i-graficheskij-interfejs/)
